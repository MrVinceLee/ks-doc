### 9.实用指令

#### 9.4.文件目录类

##### 9.4.1.pwd指令

基本语法：pwd（功能描述：显示当前工作目录的绝对路径）

##### 9.4.2.ls指令

基本语法：ls [选项] [目录或是文件]

常用选项：

-a：显示当前目录所有的文件和目录，包括隐藏的

-l：以列的方式显示信息

##### 9.4.3.cd指令

基本语法：cd [参数] （功能描述：切换到指定目录）

##### 9.4.4.mkdir指令

基本语法：mkdir [选项] 要创建的目录

常用选项：

-p：创建多级目录

##### 9.4.5.rmdir指令

功能描述：删除空目录

基本语法：rmdir [选项] 要删除的空目录

##### 9.4.6.touch指令

功能描述：创建空文件

基本语法：touch 文件名称

##### 9.4.7.cp指令

功能描述：拷贝文件到指定目录

基本语法：cp [选项] source dest

常用选项：

-r：递归复制整个文件夹

使用细节：

强制覆盖不提示的方法：\cp，\cp -r /home/bbb/opt

##### 9.4.8.rm指令

说明：rm指令移除文件或目录

基本语法：rm [选项] 要删除的文件或目录

常用选项：

-r：递归删除整个文件夹

-f：强制删除不提示

##### 9.4.9.mv指令

说明：mv 移动文件与目录或重命名

基本语法：

mv odlNameFile NewNameFile （功能描述：重命名）

mv /temp/movefile /targetFolder （功能描述：移动文件）

##### 9.4.10.cat指令

说明：查看文件内容

基本语法：cat [选项] 要查看的文件

常用选项：

-n：显示行号

使用细节：

cat只能浏览文件，而不能修改文件，为了浏览方便，一般会带上管道命令 |more

cat -n /etc/profile | more [进行交互]

##### 9.4.11.more指令

说明：more指令是一个基于vi编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。more指令中内置了若干快捷键（交互的指令），详见操作说明

基本语法：more 要查看的文件

| 操作            | 功能说明                             |
| --------------- | ------------------------------------ |
| 空白键（space） | 代表向下翻一页                       |
| Enter           | 代表向下翻「一行」                   |
| q（quit）       | 代表立刻离开more，不再显示该文件内容 |
| Ctrl+F（front） | 向下滚动一屏                         |
| Ctrl+B（back）  | 返回上一屏                           |
| =               | 输出当前行的行号                     |
| :f              | 输出文件名和当前行的行号             |

##### 9.4.12.less指令

说明：less指令用来分屏查看文件内容，它的功能与more指令类似，但是比more指令更加强大，支持各种显示终端，less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。

基本语法：less 要查看的文件

操作说明：

| 操作         | 功能说明                                         |
| ------------ | ------------------------------------------------ |
| 空白键       | 向下翻动一页                                     |
| 「pagedown」 | 向下翻动一页                                     |
| 「pageup」   | 向上翻动一页                                     |
| /字串        | 向下搜寻「字串」的功能；n：向下查找；N：向上查找 |
| ?字串        | 向上搜寻「字串」的功能；n：向下查找；N：向上查找 |
| q            | 离开less这个程序                                 |

##### 9.4.13.echo指令

说明：echo 输出内容到控制台

基本语法：echo [选项] [输出内容]

##### 9.4.14.head指令

说明：head用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容

基本语法：

head 文件（功能描述：查看文件头10行内容）

head -n 5 文件（功能描述：查看文件头5行内容，5可以是任意行数）

##### 9.4.15.tail指令

说明：tail用于输出文件中尾部的内容，默认情况喜爱tail指令显示文件的前10行内容。

基本语法：

1）tail 文件 （功能描述：查看文件尾10行内容）

2）tail -n 5 文件 （功能描述：查看文件尾5行内容，5可以是任意行数）

3）tail -f 文件 （功能描述：实时追踪该文档的所有更新）

##### 9.4.16. > 指令和 >> 指令

说明：> 输出重定向和 >> 追加

基本语法：

1）ls -l>文件（功能描述：列表的内容写入文件a.txt中（覆盖写））

2）ls -l>>文件（功能描述：列表的内容追加到文件aa.txt的末尾）

3）cat 文件1>文件2（功能描述：将文件1的内容覆盖到文件2）

4）echo "内容" >> 文件（追加）

##### 9.4.17.ln指令

说明：软链接也称为符号链接，类似于windows里的快捷方式，主要存放了链接其他文件的路径

基本语法：

ln -s [原文件或目录] [软链接名]（功能描述：给原文件创建一个软链接）

##### 9.4.18.history指令

说明：查看已经执行过的历史命令，也可以执行历史命令

基本语法：history（功能描述：查看已经执行过的历史命令）

案例：

history

history 10

!5（执行历史编号为5的指令）

#### 9.5.时间日期类

##### 9.5.1.date指令-显示当前日期

基本语法：

1）date（功能描述：显示当前时间）

2）date+%Y（功能描述：显示当前年份）

3）date+%m（功能描述：显示当前月份）

4）date+%d（功能描述：显示当前是哪一天）

5）date "+%Y-%m-%d %H:%M:%S" （功能描述：显示年月日时分秒）

案例：

date "+%Y-%m-%d %H:%M:%S"

##### 9.5.2.date指令-设置日期

基本语法：date -s 字符串时间

案例：date -s "2020-11-03 20:02:10"

##### 9.5.3.cal指令

说明：查看日历指令 cal

基本语法：cal [选项] （功能描述：不加选项，显示本月日历）

案例：

显示2020年日历：cal 2020

#### 9.6.搜索查找类

##### 9.6.1.find指令

说明：find指令从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端。

基本语法：find [搜索范围] [选项]

选项说明：

| 选项            | 功能                             |
| --------------- | -------------------------------- |
| -name<查询方式> | 按照指定的文件名查找模式查找文件 |
| -user<用户名>   | 查找属于指定用户名所有文件       |
| -size<文件大小> | 按照指定的文件大小查找文件       |

##### 9.6.2.locate指令

说明：locate指令可以快速定位文件路径。localte指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位给定的文件。locate指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新locate时刻。

基本语法：locate 搜索文件

特别说明：由于locate指令基于数据库进行查询，所以第一次运行前，必须使用updatedb指令创建locate数据库。

案例：

locate hello.txt

which指令，可以查看某个指令在哪个目录下

which ls

##### 9.6.3.grep指令和管道符号|

说明：grep过滤查找，管道符，"|"，表示将前一个命令的处理结果输出传递给后面的命令处理。

基本语法：grep [选项] 查找内容 源文件

常用选项：

| 选项 | 功能             |
| ---- | ---------------- |
| -n   | 显示匹配行及行号 |
| -i   | 忽略字母大小写   |

#### 9.7.压缩和解压类

##### 9.7.1.gzip/gunzip指令

说明：gzip用于压缩文件，gunzip用于解压的

基本语法：

gzip 文件（功能描述：压缩文件，只能将文件压缩为*.gz文件）

gunzip 文件.gz（功能描述：解压缩文件命令）

##### 9.7.2.zip/unzip指令

说明：zip用于压缩文件，unzip用于解压的

基本语法：

zip [选项] xxx.zip 将要压缩的内容（desc：压缩文件和目录的命令）

unzip [选项] xxx.zip（desc：解压缩文件）

zip常用选项

-r：递归压缩，即压缩目录

unzip的常用选项

-d<目录>：指定解压后文件的存放目录

##### 9.7.3.tar指令

说明：tar指令是打包指令，最后打包后的文件是.tar.gz的文件。

基本语法：

tar [选项] xxx.tar.gz 打包的内容（desc：打包目录，压缩后的文件格式.tar.gz）

选项说明：

| 选项 | 功能               |
| ---- | ------------------ |
| -c   | 产生.tar打包文件   |
| -v   | 显示详细信息       |
| -f   | 指定压缩后的文件名 |
| -z   | 打包同时压缩       |
| -x   | 解包.tar文件       |

案例：

1）压缩多个文件

tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt

2）压缩文件夹

tar -zcvf myhome.tar.gz /home/

3）解压到当前目录

tar -zxvf pc.tar.gz

4）解压到指定目录

a）mkdir /opt/tmp2

b）tar -zxvf /home/myhome.tar.gz **-C** /opt/tmp2

### 14.进程管理

#### 14.2.显示系统执行的进程

##### 14.2.2.ps指令

说明：ps命令是用来查看目前系统中，有哪些正在执行，以及它们执行的状况。可以不加任何参数。

指令语法：ps -aux|grep xxx

选项说明：

| 选项 | 功能                       |
| ---- | -------------------------- |
| -a   | 显示当前终端的所有进程信息 |
| -u   | 以用户的格式显示进程信息   |
| -x   | 显示后台进程运行的参数     |

参数说明：

| 参数     | 说明                                                         |
| -------- | ------------------------------------------------------------ |
| System V | 展示风格                                                     |
| USER     | 用户进程                                                     |
| PID      | 进程号                                                       |
| %CPU     | 进程占用CPU的百分比                                          |
| %MEM     | 进程占用物理内存的百分比                                     |
| VSZ      | 进程占用的虚拟内存大小（单位：KB）                           |
| RSS      | 进程占用的物理内存大小（单位：KB）                           |
| TT       | 终端名称，缩写                                               |
| STAT     | 进程状态其中S-睡眠，s-表示该进程是会话的先导进程，N-表示进程拥有比普通优先级更低的优先级，R-正在运行，D-短期等待，Z-僵死进程，T-被跟踪或者被停止等等 |
| STARTED  | 进程的启动时间                                               |
| TIME     | CPU时间，即进程使用CPU的总时间                               |
| COMMAND  | 启动进程所用的命令和参数，如果过长会被截断显示               |

案例：

要求：以全格式显示当前所有的进程，查看进程的父进程。查看sshd的父进程信息

ps -ef 是以全格式显示当前所有的进程

选项：

| 参数 | 说明         |
| ---- | ------------ |
| -e   | 显示所有进程 |
| -f   | 全格式       |

ps -ef|grep sshd

是BSD风格

| 参数  | 说明                                                         |
| ----- | ------------------------------------------------------------ |
| UID   | 用户ID                                                       |
| PID   | 进程ID                                                       |
| PPID  | 父进程ID                                                     |
| C     | CPU用于计算执行优先级的因子。数值越大，表名进程是CPU密集型运算，执行优先级会降低；数值越小，表名进程是I/O密集型运算，执行优先级会提高 |
| STIME | 进程启动的时间                                               |
| TTY   | 完整的终端名称                                               |
| TIME  | CPU时间                                                      |
| CMD   | 启动进程所用的命令和参数                                     |

#### 14.3.终止进程kill和killall

##### 14.3.1.介绍：

若是某个进程执行一半需要停止时，或是已经消耗了很大的系统资源时，此时可以考虑停止该进程。使用kill命令来完成此项任务。

##### 14.3.2.基本语法

kill [选项] 进程号（desc：通过进程号杀死/终止进程）

killall 进程名称（desc：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）

##### 14.3.3.常用选项

-9：表示强迫进程立即停止

##### 14.3.4.最佳实践



#### 14.4.查看进程树pstree

##### 14.4.1.基本语法

pstree [选项]，可以更加直观的来看进程信息

##### 14.4.2.常用选项

-p：显示进程的PID

-u：显示进程的所属用户

#### 14.5.服务(service)管理

##### 14.5.1.介绍：

服务(service)本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他程序的请求，比如(mysqld,sshd防火墙等)，因此我们又称为守护进程，是Linux中非常重要的知识点。

##### 14.5.2.service管理指令

1）service 服务名 [start|stop|restart|reload|status]

2）在CentOS7.0后，很多服务不再使用service，而是systemctl

3）service指令管理的服务在 /etc/init.d 查看

##### 14.5.4.查看服务名

方式1：使用 setup -> 系统服务 就可以看到全部

方式2：/etc/init.d 看到 service 指令管理的服务

ls -l /etc/init.d

##### 14.5.5.服务的运行级别(runlevel指令)：

Linux系统有7种运行级别(runlevel)：常用的是级别3和5

运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动

运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆

运行级别2：多用户状态（没有NFS），不支持网络

运行级别3：完全的多用户状态（有NFS），无界面，登陆后进入控制台命令行模式

运行级别4：系统未使用，保留

运行级别5：X11控制台，登陆后进入图形GUI模式

运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动

开机的流程说明：

开机 -> BIOS -> /boot ->systemd进程1 -> 运行级别 -> 运行级对应的服务

##### 14.5.6.CentOS7后运行级别说明

在 /etc/init.d

进行了简化，如下：

##### 14.5.7.chkconfig指令

介绍：

通过chkconfig命令可以给服务的各个运行级别设置自启动/关闭

chkconfig指令管理的服务在 /etc/init.d 查看

注意：Contos7.0后，很多服务使用systemctl管理

##### 14.5.8.systemctl指令

基本语法：

systemctl [start|stop|restart|status] 服务名

systemctl 指令管理的服务在 /usr/lib/systemd/system 查看

##### 14.5.9.systemctl设置服务的自启动状态

systemctl list-unit-files [|grep 服务名]（查看服务开机启动状态，grep可以进行过滤）

systemctl enable 服务名（设置服务开机启动）

systemctl disable 服务名（关闭服务开机启动）

systemctl is-enabled 服务名（查询某个服务是否是自启动的）

##### 14.5.10.应用案例：

查看当前防火墙的状况，关闭防火墙和重启防火墙。=>firewalld.service

systemctl status firewalld

systemctl stop firewalld

systemctl start firewalld

##### 14.5.11.细节讨论

关闭或者启用防火墙后，立即生效。[telnet 测试 某个端口即可]

这种方式只是临时生效，当重启系统后，还是回归以前对服务的设置。

如何希望设置某个服务自启动或关闭永久生效，要使用

systemctl [ebable|disable] 服务名

##### 14.5.12.打开或者关闭指定端口

打开防火墙之后打开指定端口，比如80、22、8080

##### 14.5.13.firewall指令

1）打开端口：firewall-cmd --permanent --add-port=端口号/协议

2）关闭端口：firewall-cmd --permanent --remove-port=端口号/协议

3）重新载入，才能生效：firewall-cmd --reload

4）查询端口是否开放：firewall-cmd --query-port=端口/协议

##### 14.5.14.应用案例：

1）启用防火墙，测试111端口是否能telnet，不行

2）开放111端口

firewall-cmd --premanent --add-port=111/tcp；需要firewall-cmd --reload

3）再次关闭111端口

firewall-cmd --premanent --remove-port=111/tcp；需要firewall-cmd --reload

#### 14.6.动态监控进程

##### 14.6.1.介绍：

top与ps命令很相似。它们都用来显示正在执行的进程。top与ps最大的不同之处，在于top在执行一段时间可以更新正在运行的进程。

##### 14.6.2.基本语法

top [选项] 

##### 14.6.3.选项说明

| 选项    | 功能                                       |
| ------- | ------------------------------------------ |
| -d 秒数 | 指定top命令每隔几秒更新。默认是3秒         |
| -i      | 使top不显示任何闲置或者僵死进程            |
| -p      | 通过指定监控进程ID来仅仅监控某个进程的状态 |











































