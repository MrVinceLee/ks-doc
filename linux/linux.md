

### 6.Vi和Vim编辑器

#### 6.1.vi和vim的基本介绍

Linux系统会内置vi文本编辑器

Vim 具有程序编辑的能力，可以看做是 Vi 的增强版本，可以主动的以字体颜色辨别语法的正确性，方便程序设计、代码补充、编辑及错误跳转等方便编程的功能特别丰富，在程序员中被广泛使用。

#### 6.2.vi和vim常用的三种模式

##### 6.2.1.正常模式

以 vim 打开一个档案就直接进入一般模式了（这是默认的模式）。在这个模式中，你可以使用「上下左右」按键来移动光标，你可以使用「删除字符」或「删除整行」来处理档案内容，也可以使用「复制、粘贴」来处理你的文件数据。

##### 6.2.2.插入模式

按下 i, I, o, O, a, A, r, R 等任何一个字母之后才会进入编辑模式，一般来说按i即可。

##### 6.2.3.命令行模式

输入 esc 再输入：在这个模式当中，可以提供你相关指令，完成读取、存盘、替换、离开 vim、显示行号等的动作则是在此模式中达成的！

#### 6.3.vi和vim基本使用

使用vim开发一个Hello.java程序，保存、步骤说明和演示

#### 6.4.各种模式的相互切换

![image-20230514184252954](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305141842025.png)

#### 6.5.vi和vim快捷键

##### 6.5.1.快捷键使用练习

1）拷贝当前行 yy，拷贝当前行向下的 5 行 5yy，并粘贴（输入p）

2）删除当前行 dd，删除当前行向下的 5 行 5dd

3）在文件中查找某个单词 [命令行下 /关键字，回车查找，输入 n 就是查找下一个]

4）设置文件的行号，取消文件的行号.[命令行下 :set nu 和 :set nonu]

5）编辑 /etc/profile 文件，在一般模式下，使用快捷键到该文档的最末行 [G] 和和最首行 [gg]

6）在一个文件中输入 "hello"，在一般模式下，然后又撤销这个动作 u

7）编辑 /etc/profile 文件，在一般模式下，并将光标移动到任何位置，输入 20，再输入 shift+g，即可跳到相应行数

9）快捷键的键盘对应图

![image-20230514210345294](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305142103355.png)

### 7.开机、重启、用户登录注销

#### 7.1.关机&重启命令

##### 7.1.1.基本介绍

1）shutdown -h now 立刻进行关机

2）shutdown -h 1 "hello，1 分钟后会关机了"

3）shutdown -r now 现在重新启动计算机

4）half 关机，作用和上面一样

5）reboot 现在重新启动计算机

6）sync 把内存的数据同步到磁盘

##### 7.1.2.注意细节

1）不管是重启系统还是关闭系统，首先要运行 sync 命令，把内存中的数据写到磁盘

2）目前的 shutdown/reboot/halt 等命令均已经在关机前进行了sync

#### 7.2.用户登录和注销

##### 7.2.1.基本介绍

1）登录时尽量少用 root 账号登录，因为他是系统管理员，最大的权限，避免操作失误。可以利用普通用户登录，登录后再用 "su - 用户名" 命令来切换成系统管理员身份

2）在提示符下输入 logout即可注销用户

##### 7.2.2.使用细节

1）logout 注销指令在图形运行级别无效，在运行级别 3 下有效

### 8.用户管理



















### 9.实用指令

#### 9.3.帮助指令

##### 9.3.1.man获得帮助信息

基本语法：man [命令或配置文件]（desc：获得帮助信息）

| 字段           | 说明                       |
| -------------- | -------------------------- |
| Name           | 显示命令名和一段简短的描述 |
| Synopsis       | 命令的语法                 |
| Confi guration | 命令配置信息               |
| Description    | 命令的一般性描述           |
| Options        | 命令选项描述               |
| Exit Status    | 命令的退出状态指示         |
| Return Value   | 命令的返回值               |
| Errors         | 命令的错误消息             |
| Environment    | 描述所使用的环境变量       |
| Files          | 命令用到的文件             |
| Versions       | 命令的版本信息             |
| Conforming To  | 命名所遵从的标准           |
| Notes          | 其他有帮助的资料           |
| Bugs           | 提供提交bug的途径          |
| Example        | 展示命令的用法             |
| Authors        | 命令开发人员的信息         |
| Copyright      | 命令源代码的版权状况       |
| See Also       | 与该命令类型的其他命令     |

| 数字 | 来自的内容区域说明       |
| ---- | ------------------------ |
| 1    | 可执行程序或shell命令    |
| 2    | 系统调用                 |
| 3    | 库调用                   |
| 4    | 特殊文件                 |
| 5    | 文件格式与约定           |
| 6    | 游戏                     |
| 7    | 概览、约定及杂项         |
| 8    | 超级用户和系统管理员命令 |
| 9    | 内核例程                 |



#### 9.4.文件目录类

##### 9.4.1.pwd指令

基本语法：pwd（功能描述：显示当前工作目录的绝对路径）

##### 9.4.2.ls指令

基本语法：ls [选项] [目录或是文件]

常用选项：

-a：显示当前目录所有的文件和目录，包括隐藏的

-l：以列的方式显示信息

##### 9.4.3.cd指令

基本语法：cd [参数] （功能描述：切换到指定目录）

##### 9.4.4.mkdir指令

基本语法：mkdir [选项] 要创建的目录

常用选项：

-p：创建多级目录

##### 9.4.5.rmdir指令

功能描述：删除空目录

基本语法：rmdir [选项] 要删除的空目录

##### 9.4.6.touch指令

功能描述：创建空文件

基本语法：touch 文件名称

##### 9.4.7.cp指令

功能描述：拷贝文件到指定目录

基本语法：cp [选项] source dest

常用选项：

-r：递归复制整个文件夹

使用细节：

强制覆盖不提示的方法：\cp，\cp -r /home/bbb/opt

##### 9.4.8.rm指令

说明：rm指令移除文件或目录

基本语法：rm [选项] 要删除的文件或目录

常用选项：

-r：递归删除整个文件夹

-f：强制删除不提示

##### 9.4.9.mv指令

说明：mv 移动文件与目录或重命名

基本语法：

mv odlNameFile NewNameFile （功能描述：重命名）

mv /temp/movefile /targetFolder （功能描述：移动文件）

##### 9.4.10.cat指令

说明：查看文件内容

基本语法：cat [选项] 要查看的文件

常用选项：

-n：显示行号

使用细节：

cat只能浏览文件，而不能修改文件，为了浏览方便，一般会带上管道命令 |more

cat -n /etc/profile | more [进行交互]

##### 9.4.11.more指令

说明：more指令是一个基于vi编辑器的文本过滤器，它以全屏幕的方式按页显示文本文件的内容。more指令中内置了若干快捷键（交互的指令），详见操作说明

基本语法：more 要查看的文件

| 操作            | 功能说明                             |
| --------------- | ------------------------------------ |
| 空白键（space） | 代表向下翻一页                       |
| Enter           | 代表向下翻「一行」                   |
| q（quit）       | 代表立刻离开more，不再显示该文件内容 |
| Ctrl+F（front） | 向下滚动一屏                         |
| Ctrl+B（back）  | 返回上一屏                           |
| =               | 输出当前行的行号                     |
| :f              | 输出文件名和当前行的行号             |

##### 9.4.12.less指令

说明：less指令用来分屏查看文件内容，它的功能与more指令类似，但是比more指令更加强大，支持各种显示终端，less指令在显示文件内容时，并不是一次将整个文件加载之后才显示，而是根据显示需要加载内容，对于显示大型文件具有较高的效率。

基本语法：less 要查看的文件

操作说明：

| 操作         | 功能说明                                                     |
| ------------ | ------------------------------------------------------------ |
| 空白键       | 向下翻动一页                                                 |
| 「pagedown」 | 向下翻动一页                                                 |
| 「pageup」   | 向上翻动一页                                                 |
| /字串        | 向下搜寻「字串」的功能；<br />n：向下查找；<br />N：向上查找 |
| ?字串        | 向上搜寻「字串」的功能；<br />n：向下查找；<br />N：向上查找 |
| q            | 离开less这个程序                                             |

##### 9.4.13.echo指令

说明：echo 输出内容到控制台

基本语法：echo [选项] [输出内容]

##### 9.4.14.head指令

说明：head用于显示文件的开头部分内容，默认情况下head指令显示文件的前10行内容

基本语法：

head 文件（功能描述：查看文件头10行内容）

head -n 5 文件（功能描述：查看文件头5行内容，5可以是任意行数）

##### 9.4.15.tail指令

说明：tail用于输出文件中尾部的内容，默认情况喜爱tail指令显示文件的前10行内容。

基本语法：

1）tail 文件 （功能描述：查看文件尾10行内容）

2）tail -n 5 文件 （功能描述：查看文件尾5行内容，5可以是任意行数）

3）tail -f 文件 （功能描述：实时追踪该文档的所有更新）

##### 9.4.16. > 指令和 >> 指令

说明：> 输出重定向和 >> 追加

基本语法：

1）ls -l>文件（功能描述：列表的内容写入文件a.txt中（覆盖写））

2）ls -l>>文件（功能描述：列表的内容追加到文件aa.txt的末尾）

3）cat 文件1>文件2（功能描述：将文件1的内容覆盖到文件2）

4）echo "内容" >> 文件（追加）

##### 9.4.17.ln指令

说明：软链接也称为符号链接，类似于windows里的快捷方式，主要存放了链接其他文件的路径

基本语法：

ln -s [原文件或目录] [软链接名]（功能描述：给原文件创建一个软链接）

##### 9.4.18.history指令

说明：查看已经执行过的历史命令，也可以执行历史命令

基本语法：history（功能描述：查看已经执行过的历史命令）

案例：

history

history 10

!5（执行历史编号为5的指令）

#### 9.5.时间日期类

##### 9.5.1.date指令-显示当前日期

基本语法：

1）date（功能描述：显示当前时间）

2）date+%Y（功能描述：显示当前年份）

3）date+%m（功能描述：显示当前月份）

4）date+%d（功能描述：显示当前是哪一天）

5）date "+%Y-%m-%d %H:%M:%S" （功能描述：显示年月日时分秒）

案例：

date "+%Y-%m-%d %H:%M:%S"

##### 9.5.2.date指令-设置日期

基本语法：date -s 字符串时间

案例：date -s "2020-11-03 20:02:10"

##### 9.5.3.cal指令

说明：查看日历指令 cal

基本语法：cal [选项] （功能描述：不加选项，显示本月日历）

案例：

显示2020年日历：cal 2020

#### 9.6.搜索查找类

##### 9.6.1.find指令

说明：find指令从指定目录向下递归地遍历其各个子目录，将满足条件的文件或者目录显示在终端。

基本语法：find [搜索范围] [选项]

选项说明：

| 选项            | 功能                             |
| --------------- | -------------------------------- |
| -name<查询方式> | 按照指定的文件名查找模式查找文件 |
| -user<用户名>   | 查找属于指定用户名所有文件       |
| -size<文件大小> | 按照指定的文件大小查找文件       |

##### 9.6.2.locate指令

说明：locate指令可以快速定位文件路径。localte指令利用事先建立的系统中所有文件名称及路径的locate数据库实现快速定位给定的文件。locate指令无需遍历整个文件系统，查询速度较快。为了保证查询结果的准确度，管理员必须定期更新locate时刻。

基本语法：locate 搜索文件

特别说明：由于locate指令基于数据库进行查询，所以第一次运行前，必须使用updatedb指令创建locate数据库。

案例：

locate hello.txt

which指令，可以查看某个指令在哪个目录下

which ls

##### 9.6.3.grep指令和管道符号|

说明：grep过滤查找，管道符，"|"，表示将前一个命令的处理结果输出传递给后面的命令处理。

基本语法：grep [选项] 查找内容 源文件

常用选项：

| 选项 | 功能             |
| ---- | ---------------- |
| -n   | 显示匹配行及行号 |
| -i   | 忽略字母大小写   |

#### 9.7.压缩和解压类

##### 9.7.1.gzip/gunzip指令

说明：gzip用于压缩文件，gunzip用于解压的

基本语法：

gzip 文件（功能描述：压缩文件，只能将文件压缩为*.gz文件）

gunzip 文件.gz（功能描述：解压缩文件命令）

##### 9.7.2.zip/unzip指令

说明：zip用于压缩文件，unzip用于解压的

基本语法：

zip [选项] xxx.zip 将要压缩的内容（desc：压缩文件和目录的命令）

unzip [选项] xxx.zip（desc：解压缩文件）

zip常用选项

-r：递归压缩，即压缩目录

unzip的常用选项

-d<目录>：指定解压后文件的存放目录

##### 9.7.3.tar指令

说明：tar指令是打包指令，最后打包后的文件是.tar.gz的文件。

基本语法：

tar [选项] xxx.tar.gz 打包的内容（desc：打包目录，压缩后的文件格式.tar.gz）

选项说明：

| 选项 | 功能               |
| ---- | ------------------ |
| -c   | 产生.tar打包文件   |
| -v   | 显示详细信息       |
| -f   | 指定压缩后的文件名 |
| -z   | 打包同时压缩       |
| -x   | 解包.tar文件       |

案例：

1）压缩多个文件

tar -zcvf pc.tar.gz /home/pig.txt /home/cat.txt

2）压缩文件夹

tar -zcvf myhome.tar.gz /home/

3）解压到当前目录

tar -zxvf pc.tar.gz

4）解压到指定目录

a）mkdir /opt/tmp2

b）tar -zxvf /home/myhome.tar.gz **-C** /opt/tmp2

### 10.组管理和权限管理

#### 10.1.Linux组基本介绍

在 linux 中的每个用户必须属于一个组，不能独立于组外。在linux中每个文件有所有者、所在组、其它组的概念。

1）所有者

2）所在组

3）其它组

4）改变用户所在的组

#### 10.2.文件/目录 所有者

一般为文件的创建者，谁创建了该文件，就自然的成为该文件的所有者。

##### 10.2.1.查看文件的所有者

指令：ls -ahl

应用实例

##### 10.2.2.修改文件所有者

指令：chown 用户名 文件名

应用案例

要求：使用 root 创建一个文件 apple.txt，然后将其所有者修改成 tom

chown tom apple.txt

#### 10.3.组的创建

##### 10.3.1.基本指令

groupadd 组名

##### 10.3.2.应用实例

创建一个组 monster

groupadd monster

创建一个用户 fox，并放入到 monster 组中

useradd -g monster fox

#### 10.4.文件/目录 所在组

当某个用户创建了一个文件后，这个文件的所在组就是该用户所在的组（默认）

##### 10.4.1.查看文件/目录所在组

基本指令

ls -ahl

应用实例，使用 fox 来创建一个文件，看看该文件属于哪个组？

##### 10.4.2.修改文件/目录所在的组

基本指令：

chgrp 组名 文件名

应用实例

使用 root 用户创建文件 orange.txt，看看当前这个文件属于哪个组，然后将这个文件所在组，修改到 fruit 组

1.groupadd fruit

2.touch orange.txt

3.看看当前这个文件属于哪个组 -> root 组

4.chgrp fruit orange.txt

#### 10.5.其它组

除文件的所有者和所在组的用户外，系统的其他用户都是文件的其它组

#### 10.6.改变用户所在组

在添加用户时，可以指定将该用户添加到哪个组中，同样的用 root 的管理权限可以改变某个用户所在的组

##### 10.6.1.改变用户所在组

usermod -g 新组名 用户名

usermod -d 目录名 用户名 改变该用户登录的初始目录。特别说明：用户需要有进入到新目录的权限。

##### 10.6.2.应用实例

将 zwj 这个用户从原来所在组，修改到 wudang 组

usermod -g wudang zwj

#### 10.7.权限的基本介绍

ls -l 中显示的内容如下：

-rwxrw-r-- 1 root root 1213 Feb 2 08:36 abc

| 0-9位说明 | 说明                                                         |
| --------- | ------------------------------------------------------------ |
| 第0位     | 确定文件类型（d，-，l，c，b）<br />d：目录，相当于 windows 的文件夹<br />-：文件<br />l：链接，相当于 windows 的快捷方式<br />c：字符设备文件，鼠标，键盘<br />b：块设备，比如硬盘 |
| 第1-3位   | 确定所有者（该文件的所有者）<br />拥有该文件的权限。---User  |
| 第4-6位   | 确定所属组（同用户组的）<br />拥有该文件的权限。---Group     |
| 第7-9位   | 确定其他用户拥有该文件的权限。---Other                       |

#### 10.8.rwx权限详解

##### 10.8.1.rwx作用到文件

1）[r] 代表可读（read）：可以读取，查看

2）[w] 代表可写（write）：可以修改，但是不代表可以删除该文件，删除一个文件的前提条件是对该文件所在的目录有写权限，才能删除该文件

3）[x] 代表可执行（execute）：可以被执行

#### 10.9.文件及目录权限实际案例

10.9.1.ls -l 中显示的内容如下:

-rwxrw-r-- 1 root root 1213 Feb 2 09:39 abc 

10个字符确定不同用户能对文件干什么

第一个字符代表文件类型: - l d c b

其余字符每 3 个一组(rwx) 读(r) 写(w) 执行(x)

第一组 rwx : 文件拥有者的权限是读、写和执行

第二组 rw- : 与文件拥有者同一组的用户的权限是读、写但不能执行

第三组 r-- : 不与文件拥有者同组的其他用户的权限是读不能写和执行

可用数字表示为: r=4,w=2,x=1 因此 rwx=4+2+1=7 , 数字可以进行组合

其它说明

1 文件:硬连接数或 目录:子目录数

root 用户

root 组

1213 文件大小(字节)，如果是文件夹，显示 4096 字节

Feb 2 09:39 最后修改日期

abc 文件名

#### 10.10.修改权限-chmod

##### 10.10.1.基本说明:

通过 chmod 指令，可以修改文件或者目录的权限。

##### 10.10.2.第一种方式:+ 、-、= 变更权限

u:所有者 g:所有组 o:其他人 a:所有人(u、g、o 的总和)

1）chmod u=rwx,g=rx,o=x 文件/目录名

2）chmod o+w 文件/目录名

3）chmod a-x 文件/目录名

 案例演示

1）给 abc 文件 的所有者读写执行的权限，给所在组读执行权限，给其它组读执行权限。

chmod u=rwx,g=rx,o=rx abc

2）给 abc 文件的所有者除去执行的权限，增加组写的权限

chmod u-x,g+w abc

3）给 abc 文件的所有用户添加读的权限

chmod a+r abc

##### 10.10.3.第二种方式:通过数字变更权限

r=4 w=2 x=1 rwx=4+2+1=7

chmod u=rwx,g=rx,o=x 文件目录名

相当于 chmod 751 文件/目录名

案例演示

要求:将 /home/abc.txt 文件的权限修改成 rwxr-xr-x, 使用给数字的方式实现:

chmod 755 /home/abc.txt

#### 10.11.修改文件所有者-chown

##### 10.11.1 基本介绍

chown newowner 文件/目录 改变所有者

chown newowner:newgroup 文件/目录 改变所有者和所在组

-R 如果是目录 则使其下所有子文件或目录递归生效

案例演示

1）请将 /home/abc.txt 文件的所有者修改成 tom

chown tom /home/abc.txt

2）请将/home/test目录下所有的文件和目录的所有者都修改成tom

chown -R tom /home/test

#### 10.12.修改文件/目录所在组-chgrp

##### 10.12.1.基本介绍

chgrp newgroup 文件/目录 【 改变所在组】

##### 10.12.2.案例演示

1）请将 /home/abc .txt 文件的所在组修改成 shaolin (少林)

groupadd shaolin

chgrp shaolin /home/abc.txt

2）请将 /home/test 目录下所有的文件和目录的所在组都修改成 shaolin(少林)

chgrp -R shaolin /home/test

### 11.定时任务调度

#### 11.1.crond任务调度

crontab 进行 定时任务的设置

##### 11.1.1.概述

任务调度：是指系统在某个时间执行的特定的命令或程序。

任务调度分类：1.系统工作：有些重要的工作必须周而复始地执行。如病毒扫描等

个别用户工作：个别用户可能希望执行某些程序，比如对mysql数据库的备份。

示意图

![image-20230508192251484](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305081922528.png)

##### 11.1.2.基本语法

crontab [选项]

##### 11.1.3.常用选项

| -e   | 编辑crontab定时任务           |
| ---- | ----------------------------- |
| -l   | 查询crontab任务               |
| -r   | 删除当前用户所有的crontab任务 |

##### 11.1.4.快速入门

设置任务调度文件：/etc/crontab

设置个人任务调度：执行 crontab -e 命令

接着输入任务到调度文件

如：*/1 * * * * ls -l /etc/ > /tmp/to.txt 命令

意思说每小时的每分钟执行 ls -l /etc/ > /tmp/to.txt 命令



参数细节说明

5个占位符的说明：

| 项目       | 含义                 | 范围                    |
| ---------- | -------------------- | ----------------------- |
| 第一个 "*" | 一小时当中的第几分钟 | 0-59                    |
| 第二个 "*" | 一天当中的第几小时   | 0-23                    |
| 第三个 "*" | 一个月当中的第几天   | 1-31                    |
| 第四个 "*" | 一年当中的第几月     | 1-12                    |
| 第五个 "*" | 一周当中的星期几     | 0-7（0和7都代表星期日） |

特殊符号的说明

| 特殊符号 | 含义                                                         |
| -------- | ------------------------------------------------------------ |
| *        | 代表任何时间。<br />比如第一个 "*" 就代表一小时中每分钟都执行一次的意思 |
| ,        | 代表不连续的时间。<br />比如"0 8,12,16 * * * 命令"，就代表在每天的8点0分，12点0分，16点0分都执行一次命令 |
| -        | 代表连续的时间范围。<br />比如"0 5 * * 1-6 命令"，就代表在周一到周六的凌晨5点0分执行命令 |
| */n      | 代表每隔多久执行一次。<br />比如"*/10 * * * * 命令"，代表每隔10分钟就执行一遍命令 |

特殊时间执行案例

| 时间              | 含义                                                         |
| ----------------- | :----------------------------------------------------------- |
| 45 22 * * * 命令  | 在22点45分执行命令                                           |
| 0 17 * * 1 命令   | 每周1的17点0分执行命令                                       |
| 0 5 1,15 * * 命令 | 每月1号和15号的凌晨5点0分执行命令                            |
| 40 4 * * 1-5 命令 | 每周一到周五的凌晨4点40分执行命令                            |
| */10 4 * * * 命令 | 每天的凌晨4点，每隔10分钟执行一次命令                        |
| 0 0 1,15 * 1 命令 | 每月1号和15号，每周1的0点0分都会执行命令。<br />注意：星期几和几号最好不要同时出现，因为他们定义的都是天。非常容易让管理员混乱。 |

##### 11.1.5.应用实例

案例1：每隔1分钟，就将当前的日期信息，追加到/tmp/mydate 文件中

*/1 * * * * date >> /tmp/date



案例2：每隔1分钟，将当前日期和日历都追加到 /home/mycal 文件中

步骤：

（1）vim /home/my.sh 写入内容 date >> /home/mycal 和 cal >> /home/mycal

（2）给my.sh增加执行权限，chmod u+x /home/my.sh

（3）crontab -e 增加 */1 * * * * /home/my.sh

tail -f /home/mycal：实时查看文件内容



案例3：

每天凌晨2:00将mysql数据库testdb，备份到文件中。

提示：指令为mysqldump -u root -p 密码 数据库 > /home/db.bak

步骤（1）：crontab -e

步骤（2）：0 2 * * * mysqldump -u root -proot testdb > /home/db.bak



##### 11.1.6.crond服务相关指令

crontab -r：终止任务调度

crontab -l：列出当前有哪些任务调度

service crond restart：重启任务调度



#### 11.2.at定时任务

##### 11.2.1.基本介绍

1）at 命令是一次性定时计划任务，at 的守护进程 atd 会以后台模式运行，检查作业队列来运行。

2）默认情况下，atd 守护进程每 60 秒检查作业队列，有作业时，会检查作业运行时间，如果时间与当前时间匹配，则运行此作业。

3）at 命令是一次性定时计划任务，执行完一个任务后不再执行此任务了

4）在使用 at 命令的时候，一定要保证 atd 进程的启动，可以使用相关指令来查看

ps -ef | grep atd //可以检测atd是否在运行

5）画一个示意图

![image-20230510124116901](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305101241964.png)

##### 11.2.2.at 命令格式

at [选项] [时间]

Ctrl + D 结束 at 命令的输入，输出两次

##### 11.2.3.at命令选项

| 选项          | 含义                                                     |
| ------------- | -------------------------------------------------------- |
| -m            | 当指定的任务被完成后，将给用户发送邮件，即使没有标准输出 |
| -I            | atd 的别名                                               |
| -d            | atrm 的别名                                              |
| -v            | 显示任务将被执行的时间                                   |
| -c            | 打印任务的内容到标准输出                                 |
| -V            | 显示版本信息                                             |
| -q <队列>     | 使用指定的队列                                           |
| -f <文件>     | 从指定文件读入任务而不是从标准输入读入                   |
| -t <时间参数> | 以时间参数的形式提交要运行的任务                         |

##### 11.2.4.at时间定义

at指定时间的方法：

1）接受在当天的hh:mm（小时:分钟）式的时间指定。假如该时间已过去，那么就放在第二天执行。

例如：04:00

2）使用midnight（深夜），noon（中午），teatime（饮茶时间，一般是下午4点）等比较模糊的词语来指定时间。

3）采用12小时计时制，即在时间后面加上AM（上午）或PM（下午）来说明是上午还是下午。

例如：12pm

4）指定命令执行的具体时间，指定格式为month day（月 日）或 mm/dd/yy（月/日/年）或dd.mm.yy（日.月.年），指定的日期必须跟在指定时间的后面。

例如：04:00 2023-05-11

5）使用相对计时法。指定格式为：now + count time-units，now 就是当前时间，time-units 是时间单位，这里能够是 minutes（分钟）、hours（小时）、days（天）、week（星期）。count是时间的数量，几天，几小时。

例如：now + 5 minutes

6）直接使用 today （今天）、tomorrow（明天）来指定完成命令的时间。

##### 11.2.5.应用实例

案例1：2 天后的下午 5 点执行 /bin/ls /home

![image-20230511130315849](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305111303922.png)

案例2：atq命令来查看系统中有没有执行的工作任务

![image-20230512123559263](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305121235343.png)

案例3：明天 17 点钟，输出时间到指定文件内 比如：/root/date100.log

![image-20230512123850404](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305121238470.png)

案例4：2分钟后，输出时间到指定文件内 比如：/root/date200.log

![image-20230512124024117](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305121240179.png)

案例5：删除已经设置的任务，atrm的编号

atrm 4 //表示将job队列，编号为 4 的 job 删除



### 13.网络配置

#### 13.1.Linux网络配置原理图

##### 13.1.1.画出原理图，帮助理解

![image-20230507193223023](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/image-20230507193223023.png)

#### 13.2.查看网络IP和网关

##### 13.2.1.查看虚拟网络编辑器和修改IP地址

##### 13.2.2.查看网关

#### 13.3.查看windows环境中VMnet8网络配置（ipconfig指令）

#### 13.4.查看linux的网络配置ifconfig

#### 13.5.ping测试主机之间网络连通性

##### 13.5.1.基本语法

ping 目的主机（desc：测试当前服务器是否可以连接目的主机）

##### 13.5.2.应用示例

测试当前服务器是否可以连接百度

ping www.baidu.com

#### 13.6.linux网络环境配置

##### 13.6.1.第一种方法（自动获取）

说明：登陆后，通过界面的设置来自动获取ip，特点：linux启动后会自动获取IP，缺点是每次自动获取的ip地址可能不一样

##### 13.6.2.第二种方法（指定ip）

说明：直接修改配置文件来指定IP，并可以连接到外网

编辑 vi /etc/sysconfig/network-scripts/ifcfg-ens33

要求：将ip地址配置为静态的，比如：ip地址为192.168.200.130



ifcfg-ens33文件说明

| 属性                                      | 说明                                                         |
| ----------------------------------------- | ------------------------------------------------------------ |
| DEVICE=eth0                               | 接口名（设备，网卡）                                         |
| HWADDR=0:0C:2x:6x:0x:xx                   | MAC地址                                                      |
| TYPE=Ethernet                             | 网络类型（通常是Ethernet）                                   |
| UUID=926a57ba-92c6-4231-bacb-f27e5e6a9f44 | 随机 id                                                      |
| ONBOOT=yes                                | 系统启动的时候网络接口是否有效(yes/no)                       |
| BOOTPROTO=static                          | IP 的配置方法<br />[none\|static\|bootp\|dhcp]<br />（引导时不使用协议\|静态分配IP\|BOOTP协议\|DHCP协议） |
| IPADDR=192.168.200.130                    | IP 地址                                                      |
| GATEWAY=192.168.200.2                     | 网关                                                         |
| DNS1=192.168.200.2                        | 域名解析器                                                   |

重启网络服务或者重启系统生效

service network restart、reboot

#### 13.7.设置主机名和hosts映射

##### 13.7.1.设置主机名

1）为了方便记忆，可以给linux系统设置主机名，也可以根据需要修改主机名

2）指令hostname：查看主机名

3）修改文件在 /etc/hostname 指定

4）修改后，重启生效

##### 13.7.2.设置hosts映射

思考：如何通过主机名能够找到（比如ping）某个linux系统？



windows

在 C:\Windows\System32\drivers\etc\hosts 文件指定即可

案例: 192.168.200.130 hspedu100



linux

在 /etc/hosts 文件指定

案例：192.168.200.1 ThinkPad-PC

#### 13.8.主机名解析过程分析（Hosts、DNS）

##### 13.8.1.Hosts是什么

一个文本文件，用来记录IP和Hostname（主机名）的映射关系

##### 13.8.2.DNS

DNS，就是Domain Name System的缩写，翻译过来就是域名系统

是互联网上作为域名和IP地址相互映射的一个分布式数据库

##### 13.8.3.应用实例：用户在浏览器输入了www.baidu.com

1）浏览器先检查浏览器缓存中有没有该域名解析IP地址，有就先调用这个IP完成解析；如果没有，就检查DNS解析器缓存，如果有直接返回IP完成解析。这两个缓存，可以理解为本地解析器缓存

2）一般来说，当电脑第一次成功访问某一网站后，在一定时间内，浏览器或操作系统会缓存他的IP地址（DNS解析记录）.如在cmd窗口中输入

ipconfig /displaydns //DNS域名解析缓存

ipconfig /flushdns //手动清理dns缓存

3）如果本地解析器缓存没有找到对应映射，检查系统中 hosts 文件中有没有配置对应的 IP 映射，如果有，则完成解析并返回。

4）如果本地DNS解析器缓存和hosts文件中均没有找到对应的IP，则到域名服务DNS进行解析域名

5）示意图

![image-20230508125453535](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305081254615.png)





### 14.进程管理

#### 14.2.显示系统执行的进程

##### 14.2.2.ps指令

说明：ps命令是用来查看目前系统中，有哪些正在执行，以及它们执行的状况。可以不加任何参数。

指令语法：ps -aux|grep xxx

选项说明：

| 选项 | 功能                       |
| ---- | -------------------------- |
| -a   | 显示当前终端的所有进程信息 |
| -u   | 以用户的格式显示进程信息   |
| -x   | 显示后台进程运行的参数     |

参数说明：

| 参数    | 说明                                                         |
| ------- | ------------------------------------------------------------ |
| BSD     | 展示风格                                                     |
| USER    | 用户进程                                                     |
| PID     | 进程号                                                       |
| %CPU    | 进程占用CPU的百分比                                          |
| %MEM    | 进程占用物理内存的百分比                                     |
| VSZ     | 进程占用的虚拟内存大小（单位：KB）                           |
| RSS     | 进程占用的物理内存大小（单位：KB）                           |
| TT      | 终端名称，缩写                                               |
| STAT    | 进程状态其中<br />S-睡眠，<br />s-表示该进程是会话的先导进程，<br />N-表示进程拥有比普通优先级更低的优先级，<br />R-正在运行，<br />D-短期等待，<br />Z-僵死进程，<br />T-被跟踪或者被停止<br />等等 |
|         |                                                              |
| STARTED | 进程的启动时间                                               |
| TIME    | CPU时间，即进程使用CPU的总时间                               |
| COMMAND | 启动进程所用的命令和参数，如果过长会被截断显示               |

STAT状态位常见的状态字符

| STAT状态字符 | 说明                                                      |
| ------------ | --------------------------------------------------------- |
| D            | 无法中断的休眠状态（通常 IO 的进程）                      |
| R            | 正在运行可中在队列中可过行的                              |
| S            | 处于休眠状态                                              |
| T            | 停止或被追踪                                              |
| W            | 进入内存交换 （从内核2.6开始无效）                        |
| X            | 死掉的进程 （基本很少见）                                 |
| Z            | 僵尸进程                                                  |
| <            | 优先级高的进程                                            |
| N            | 优先级较低的进程                                          |
| L            | 有些页被锁进内存                                          |
| s            | 进程的领导者（在它之下有子进程）                          |
| l            | 多线程，克隆线程（使用 CLONE_THREAD, 类似 NPTL pthreads） |
| +            | 位于后台的进程组                                          |

![image-20230510072043896](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305100720956.png)



案例：

要求：以全格式显示当前所有的进程，查看进程的父进程。查看sshd的父进程信息

ps -ef 是以全格式显示当前所有的进程

选项：

| 参数 | 说明         |
| ---- | ------------ |
| -e   | 显示所有进程 |
| -f   | 全格式       |

ps -ef|grep sshd

是System V风格

| 参数  | 说明                                                         |
| ----- | ------------------------------------------------------------ |
| UID   | 用户ID                                                       |
| PID   | 进程ID                                                       |
| PPID  | 父进程ID                                                     |
| C     | CPU用于计算执行优先级的因子。<br />数值越大，表名进程是CPU密集型运算，执行优先级会降低；<br />数值越小，表名进程是I/O密集型运算，执行优先级会提高 |
| STIME | 进程启动的时间                                               |
| TTY   | 完整的终端名称                                               |
| TIME  | CPU时间                                                      |
| CMD   | 启动进程所用的命令和参数                                     |

![image-20230510071858587](https://cdn.jsdelivr.net/gh/mrvincelee/myimages@main/imgs/202305100718649.png)



#### 14.3.终止进程kill和killall

##### 14.3.1.介绍：

若是某个进程执行一半需要停止时，或是已经消耗了很大的系统资源时，此时可以考虑停止该进程。使用kill命令来完成此项任务。

##### 14.3.2.基本语法

kill [选项] 进程号（desc：通过进程号杀死/终止进程）

killall 进程名称（desc：通过进程名称杀死进程，也支持通配符，这在系统因负载过大而变得很慢时很有用）

##### 14.3.3.常用选项

-9：表示强迫进程立即停止

##### 14.3.4.最佳实践



#### 14.4.查看进程树pstree

##### 14.4.1.基本语法

pstree [选项]，可以更加直观的来看进程信息

##### 14.4.2.常用选项

-p：显示进程的PID

-u：显示进程的所属用户

#### 14.5.服务(service)管理

##### 14.5.1.介绍：

服务(service)本质就是进程，但是是运行在后台的，通常都会监听某个端口，等待其他程序的请求，比如(mysqld,sshd防火墙等)，因此我们又称为守护进程，是Linux中非常重要的知识点。

##### 14.5.2.service管理指令

1）service 服务名 [start|stop|restart|reload|status]

2）在CentOS7.0后，很多服务不再使用service，而是systemctl

3）service指令管理的服务在 /etc/init.d 查看

##### 14.5.4.查看服务名

方式1：使用 setup -> 系统服务 就可以看到全部

方式2：/etc/init.d 看到 service 指令管理的服务

ls -l /etc/init.d

##### 14.5.5.服务的运行级别(runlevel指令)：

Linux系统有7种运行级别(runlevel)：常用的是级别3和5

运行级别0：系统停机状态，系统默认运行级别不能设为0，否则不能正常启动

运行级别1：单用户工作状态，root权限，用于系统维护，禁止远程登陆

运行级别2：多用户状态（没有NFS），不支持网络

运行级别3：完全的多用户状态（有NFS），无界面，登陆后进入控制台命令行模式

运行级别4：系统未使用，保留

运行级别5：X11控制台，登陆后进入图形GUI模式

运行级别6：系统正常关闭并重启，默认运行级别不能设为6，否则不能正常启动

开机的流程说明：

开机 -> BIOS -> /boot ->systemd进程1 -> 运行级别 -> 运行级对应的服务

##### 14.5.6.CentOS7后运行级别说明

在 /etc/init.d

进行了简化，如下：

##### 14.5.7.chkconfig指令

介绍：

通过chkconfig命令可以给服务的各个运行级别设置自启动/关闭

chkconfig指令管理的服务在 /etc/init.d 查看

注意：Contos7.0后，很多服务使用systemctl管理

##### 14.5.8.systemctl指令

基本语法：

systemctl [start|stop|restart|status] 服务名

systemctl 指令管理的服务在 /usr/lib/systemd/system 查看

##### 14.5.9.systemctl设置服务的自启动状态

systemctl list-unit-files [|grep 服务名]（查看服务开机启动状态，grep可以进行过滤）

systemctl enable 服务名（设置服务开机启动）

systemctl disable 服务名（关闭服务开机启动）

systemctl is-enabled 服务名（查询某个服务是否是自启动的）

##### 14.5.10.应用案例：

查看当前防火墙的状况，关闭防火墙和重启防火墙。=>firewalld.service

systemctl status firewalld

systemctl stop firewalld

systemctl start firewalld

##### 14.5.11.细节讨论

关闭或者启用防火墙后，立即生效。[telnet 测试 某个端口即可]

这种方式只是临时生效，当重启系统后，还是回归以前对服务的设置。

如何希望设置某个服务自启动或关闭永久生效，要使用

systemctl [ebable|disable] 服务名

##### 14.5.12.打开或者关闭指定端口

打开防火墙之后打开指定端口，比如80、22、8080

##### 14.5.13.firewall指令

1）打开端口：firewall-cmd --permanent --add-port=端口号/协议

2）关闭端口：firewall-cmd --permanent --remove-port=端口号/协议

3）重新载入，才能生效：firewall-cmd --reload

4）查询端口是否开放：firewall-cmd --query-port=端口/协议

##### 14.5.14.应用案例：

1）启用防火墙，测试111端口是否能telnet，不行

2）开放111端口

firewall-cmd --premanent --add-port=111/tcp；需要firewall-cmd --reload

3）再次关闭111端口

firewall-cmd --premanent --remove-port=111/tcp；需要firewall-cmd --reload

#### 14.6.动态监控进程

##### 14.6.1.介绍：

top与ps命令很相似。它们都用来显示正在执行的进程。top与ps最大的不同之处，在于top在执行一段时间可以更新正在运行的进程。

##### 14.6.2.基本语法

top [选项] 

##### 14.6.3.选项说明

| 选项    | 功能                                       |
| ------- | ------------------------------------------ |
| -d 秒数 | 指定top命令每隔几秒更新。默认是3秒         |
| -i      | 使top不显示任何闲置或者僵死进程            |
| -p      | 通过指定监控进程ID来仅仅监控某个进程的状态 |

##### 14.6.4.交互操作说明：

| 操作 | 功能                          |
| ---- | ----------------------------- |
| P    | 以CPU使用率排序，默认就是此项 |
| M    | 以内存的使用率排序            |
| N    | 以PID排序                     |
| q    | 退出top                       |

##### 14.6.5.应用示例

1）案例1：监视特定用户，比如我们监控tom用户

top：输入此命令，按回车键，查看执行的进程

u：然后输入"u"回车，再输入用户名，即可

2）案例2：终止指定的进程，比如我们要结束tom登录

top：输入此命令，按回车键，查看执行的进程

k：然后输入"k"回车，再输入要结束的进程ID号

3）案例3：指定系统状态更新的时间（每隔10秒自动更新），默认是3秒

top -d 10

#### 14.7.监控网络状态

14.7.1.查看系统网络情况netstat

基本语法：netstat [选项]

选项说明：

-an 按一定顺序排列输出

-p 显示哪个进程在调用

应用案例：

请查看服务名为sshd的服务的信息

netstat -anp | grep sshd

##### 14.7.2.检测主机连接命令ping

说明：是一种网络检测工具，它主要是检测远程主机是否正常，或是两部主机间的网线或网卡故障。

如：ping 对方ip地址

### 15.RPM与YUM

#### 15.1.rpm包的管理

##### 15.1.1.介绍

rpm用于互联网下载包的打包及安装工具，它包含在某些Linux分发版中。它生成具有.RPM扩展名的文件。RPM是RedHat Package Manager（RedHat软件包管理工具）的缩写，类似windows的setup.exe，这一文件格式名称虽然打上了RedHat的标志，但理念是通用的。

Linux的分发版本都有采用（suse，redhat，centos等等），可以算是公认的行业标准了。

##### 15.1.2.rpm包的简单查询指令

rpm -qa|grep xx（desc：查询已安装的rpm列表）

举例：看看当前系统，是否安装了firefox

指令：rpm -qa|grep firefox

##### 15.1.3.rpm包名基本格式

一个rpm包名：firefox-60.2.2-1.el7.centos.x86_64

名称：firefox

版本号：60.2.2-1

适用操作系统：el7.centos.x86_64

表示centos7.x的64位系统

如果是i686、i386表示32位系统，noarch表示通用

##### 15.1.4.rpm包的其它查询指令：

rpm -qa：查询所安装的所有rpm软件包

rpm -qa|more

rpm -qa|grep X [rpm -qa|grep firefox]



rpm -q 软件包名：查询软件包是否安装

案例：rpm -q firefox

rpm -qi 软件包名：查询软件包信息

rpm -ql 软件包名：查询软件包中的文件

rpm -qf 文件全路径名：查询文件所属的软件包

案例：

1）rpm -qf /etc/passwd

2）rpm -qf /etc/install.log

##### 15.1.5.卸载rpm包

基本语法：rpm -e RPM 包的名称 //erase

应用案例：删除firefox 软件包

rpm -e firefox



细节讨论：

1）如果其他软件包依赖于您要卸载的软件包，卸载时则会产生错误信息。

如：$rpm -e foo

removing these packages would break dependencies:foo is needed by bar-1.0-1

2）如果我们就是要删除foo这个rpm包，可以增加参数 --nodeps，就可以强制删除，但是一般不推荐这样做，因为依赖于该软件包的程序可能无法运行

如：$rpm -e --nodeps foo

##### 15.1.6.安装rpm包

基本语法：rpm -ivh rpm 包全路径名称

参数说明：

i = install 安装

v = verbose 提示

h = hash 进度条



应用示例：

演示卸载和安装firefox浏览器

rpm -e firefox

rpm -ivh firefox

#### 15.2.yum

##### 15.2.1.介绍：

Yum是一个Shell前端软件包管理器。基于RPM包管理，能够从指定的服务器自动下载RPM包并且安装，可以自动处理依赖性关系，并且一次安装所有依赖的软件包。

##### 15.2.2.yum的基本指令

查询yum服务器是否有需要安装的软件

yum list|grep xx 软件列表

15.2.4.yum应用示例

案例：请使用yum的方式来安装firefox

rpm -e firefox

yum list|grep firefox

yum install firefox





































